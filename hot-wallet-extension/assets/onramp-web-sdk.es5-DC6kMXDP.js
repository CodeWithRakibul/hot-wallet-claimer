var k=function(){var t=document.createElement("style");return t.textContent=".overlay { position: fixed; z-index: 1000; width: 100vw; height: 100vh; height: 100dvh; top: 0; left: 0; overflow: hidden; background-color: rgba(0, 0, 0, 0.5); display: flex; flex-flow: row nowrap; justify-content: center; align-items: center; } .iframe { border: none; user-select: none; visibility: hidden; position: absolute; } .iframe.visible { visibility: visible; } .close-modal { font-family: Manrope, sans-serif; width: 90%; max-width: 620px; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); z-index: 9999; box-shadow: 0px 54px 200px rgba(36, 37, 57, 0.2); display: flex; flex-flow: column nowrap; justify-content: flex-start; align-items: center; padding: 35px; border-radius: 8px; background: #fff; box-sizing: border-box; } .close-modal * { box-sizing: border-box; } .close-modal__text { margin: 40px auto 30px; font-weight: 600; font-size: 24px; line-height: 36px; text-align: center; color: #242539; text-wrap: pretty; } .close-modal__button-container { width: 318px; display: flex; flex-flow: row nowrap; justify-content: space-between; align-items: center; } .close-modal__button { background: #fff; border: 2px solid #edeef3; border-radius: 74px; width: 152px; height: 56px; cursor: pointer; font-weight: 600; font-size: 14px; line-height: 21px; color: #2b2d56; text-transform: uppercase; } .close-modal__button--exit { background: #151515; box-shadow: 0px 8px 34px rgba(156, 163, 175, 0.6); color: #fff; border-color: transparent; }",t},L=function(){var t=document.createElement("div");t.classList.add("overlay");var i=document.createElement("div");return i.classList.add("loader-container"),i.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" stroke="rgb(255, 255, 255)" width = '100' height = '100' viewBox="0 0 44 44" > <g fill="none" fill-rule="evenodd" stroke-width="1"> <circle cx="22" cy="22" r="1" stroke-width="1"> <animate attributeName="r" begin="0s" calcMode="spline" dur="1.8s" keySplines="0.165, 0.84, 0.44, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 20" /> <animate attributeName="stroke-opacity" begin="0s" calcMode="spline" dur="1.8s" keySplines="0.3, 0.61, 0.355, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 0" /> </circle> <circle cx="22" cy="22" r="1" stroke-width="1"> <animate attributeName="r" begin="-0.9s" calcMode="spline" dur="1.8s" keySplines="0.165, 0.84, 0.44, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 20" /> <animate attributeName="stroke-opacity" begin="-0.9s" calcMode="spline" dur="1.8s" keySplines="0.3, 0.61, 0.355, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 0" /> </circle> </g> </svg>
	`,t.appendChild(i),t},R=function(t){var i=document.createElement("iframe");return i.setAttribute("src",t),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.id="onRampWidget",i.setAttribute("allow","microphone; camera; clipboard-read; clipboard-write"),i.classList.add("iframe"),i},O=function(){if(!document.querySelector("[data-onramp-font]")){var t=document.createElement("link");t.setAttribute("href","https://fonts.googleapis.com/css?family=Manrope:wght@400;600;700;800&display=swap"),t.setAttribute("rel","stylesheet"),t.setAttribute("data-onramp-font",""),document.head.appendChild(t)}},M=function(){var t=document.createElement("div");t.classList.add("close-modal");var i=document.createElement("div");i.classList.add("close-modal__text"),i.textContent="Are you sure you want to leave & close this widget ?";var e=document.createElement("div");e.classList.add("close-modal__button-container");var o=document.createElement("button");o.setAttribute("type","button"),o.classList.add("close-modal__button"),o.classList.add("close-modal__button--cancel"),o.textContent="Cancel",o.addEventListener("click",function(a){a.stopPropagation(),window.postMessage({eventData:{type:"ONRAMP_WIDGET_CLOSE_REQUEST_CANCELLED",isOnramp:!0}},window.location.origin)});var n=document.createElement("button");return n.setAttribute("type","button"),n.classList.add("close-modal__button"),n.classList.add("close-modal__button--exit"),n.textContent="Exit",n.addEventListener("click",function(a){a.stopPropagation(),window.postMessage({eventData:{type:"ONRAMP_WIDGET_CLOSE_REQUEST_CONFIRMED",isOnramp:!0}},window.location.origin)}),e.appendChild(o),e.appendChild(n),t.appendChild(i),t.appendChild(e),t},l=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},D=function(t){var i=document.querySelector("body"),e=document.createElement("div");e.style.width="100%",e.style.height="100%";var o=e.attachShadow({mode:"open"});o.appendChild(k());var n=R(t),a=L();return a.appendChild(n),o.appendChild(a),{body:i,iframe:n,overlay:a,shadow:o,shadowHost:e}},S=function(t){if(!l(t,"appId"))throw new Error("appId missing when initializing constructor");if(l(t,"network")&&typeof t.network!="string")throw new Error("network only accepts string values. Check param values at https://docs.onramp.money/onramp/widget-integration/hosted-mode#customisation-onramp");if(l(t,"coinAmount")&&l(t,"fiatAmount"))throw new Error("use either coinAmount or fiatAmount");if(l(t,"coinAmount")&&typeof t.coinAmount!="number")throw new Error("coinAmount only accepts number values");if(l(t,"fiatAmount")&&typeof t.fiatAmount!="number")throw new Error("fiatAmount only accepts number values");if(l(t,"paymentMethod")&&!(t?.paymentMethod===1||t?.paymentMethod===2))throw new Error("paymentMethod only accepts number values as 1 => UPI, 2 => Bank Transfers");if(l(t,"addressTag")&&!l(t,"walletAddress"))throw new Error("addressTag can only be used along with walletAddress");return!0},N=function(){try{return performance?.now()}catch(t){return console.log("getTime failed",t),0}},I="https://onramp.money",W="/main",v,w,H=function(){function t(i){var e=this;this._clientCallbacks={},this._handleEscapeClick=function(o){var n=27;if(o.key==="Escape"||o.key==="Esc"||o.keyCode===n){var a=new CustomEvent("ONRAMP_WIDGET_CLOSE_REQUEST",{detail:{eventData:{isOnramp:!0}}});window.dispatchEvent(a)}},this._widgetMessageHandler=function(o){var n,a,r,s,c,u;if(!((a=(n=o?.data)===null||n===void 0?void 0:n.eventData)===null||a===void 0)&&a.isOnramp){var d=o.data.eventData,m=new CustomEvent(d.type,{detail:d});window.dispatchEvent(m),d?.type.startsWith("ONRAMP_WIDGET_TX_")&&((s=(r=e._clientCallbacks)===null||r===void 0?void 0:r.TX_EVENTS)===null||s===void 0||s.call(r,d)),["ONRAMP_WIDGET_CLOSE_REQUEST_CONFIRMED","ONRAMP_WIDGET_READY","ONRAMP_WIDGET_FAILED","ONRAMP_WIDGET_CONTENT_COPIED"].includes(d?.type)&&((u=(c=e._clientCallbacks)===null||c===void 0?void 0:c.WIDGET_EVENTS)===null||u===void 0||u.call(c,d))}else console.log("event received from === ",o?.origin,o)},this._widgetCloseRequestHandler=function(){var o,n,a,r,s=(n=(o=e._domNodes)===null||o===void 0?void 0:o.overlay)===null||n===void 0?void 0:n.querySelector(".close-modal");s||(r=(a=e._domNodes)===null||a===void 0?void 0:a.overlay)===null||r===void 0||r.appendChild(M())},this._widgetCloseHandler=function(){e._teardownSDKEvents(),e.close()},this._widgetCloseCancelHandler=function(){var o,n,a=(n=(o=e._domNodes)===null||o===void 0?void 0:o.overlay)===null||n===void 0?void 0:n.querySelector(".close-modal");a&&a.remove()},this._widgetReadyHandler=function(){var o,n,a,r,s;(n=(o=e._domNodes)===null||o===void 0?void 0:o.overlay.querySelector(".loader-container"))===null||n===void 0||n.remove(),(s=(r=(a=e._domNodes)===null||a===void 0?void 0:a.iframe)===null||r===void 0?void 0:r.classList)===null||s===void 0||s.add("visible"),w=N(),v&&w&&console.log("Render time in seconds ~~ ",Number((w-v)/1e3).toPrecision(4))},this._widgetFailedHandler=function(){},this.close=function(){var o,n;if(e._isVisible)(n=(o=e._domNodes)===null||o===void 0?void 0:o.shadowHost)===null||n===void 0||n.remove(),e._isVisible=!1;else throw new Error("Widget is not rendered. Call show method to render the widget")},this.show=function(){var o,n;v=N(),S(e.config);{if(e._isVisible)throw new Error("Widget is already rendered. Call close method to clear it up");e._registerSDKEvents(),e._domNodes=D(e._getURL()),(o=e._domNodes.body)===null||o===void 0||o.appendChild((n=e._domNodes)===null||n===void 0?void 0:n.shadowHost),e._isVisible=!0,setTimeout(function(){e._widgetReadyHandler()},1e3)}},this.on=function(o,n){["TX_EVENTS","WIDGET_EVENTS"].includes(o)&&(e._clientCallbacks[o]=n)},this._appURL="".concat(I).concat(W),this._isVisible=!1,this.config=i,O()}return t.prototype._getURL=function(){var i=this._appURL,e=this.config,o=e.appId,n=e.walletAddress,a=e.coinCode,r=e.network,s=e.coinAmount,c=e.fiatAmount,u=e.merchantRecognitionId,d=e.paymentMethod,m=e.flowType,p=m===void 0?1:m,_=e.authToken,h=_===void 0?"":_,f=e.assetDescription,E=f===void 0?"":f,y=e.assetImage,b=y===void 0?"":y,g=e.paymentAddress,C=g===void 0?"":g,A=e.fiatType,T=e.phoneNumber,x=e.lang;switch(p){case 1:i+="/buy";break;case 2:i+="/sell";break;case 3:i+="/checkout";break;case 4:i+="/swap";break;default:i+="/buy";break}return i+="/?appId=".concat(o,"&mode=overlay&origin=").concat(window.location.origin),[1,3].includes(p)&&(n&&(i+="&walletAddress=".concat(n)),d&&(i+="&paymentMethod=".concat(d)),A&&(i+="&fiatType=".concat(A))),[3].includes(p)&&(E&&(i+="&assetDescription=".concat(E)),b&&(i+="&assetImage=".concat(b))),[2,4].includes(p)&&h&&(i+="&authToken=".concat(h)),[4].includes(p)&&C&&(i+="&paymentAddress=".concat(C)),a&&(i+="&coinCode=".concat(a)),r&&(i+="&network=".concat(r)),s&&(i+="&coinAmount=".concat(s)),c&&(i+="&fiatAmount=".concat(c)),u&&(i+="&merchantRecognitionId=".concat(u)),T&&(i+="&phoneNumber=".concat(T)),x&&(i+="&lang=".concat(x)),i+="&clientHeight=".concat(window.innerHeight),i},t.prototype._registerSDKEvents=function(){window.addEventListener("message",this._widgetMessageHandler),window.addEventListener("keydown",this._handleEscapeClick),window.addEventListener("ONRAMP_WIDGET_CLOSE_REQUEST",this._widgetCloseRequestHandler),window.addEventListener("ONRAMP_WIDGET_CLOSE_REQUEST_CONFIRMED",this._widgetCloseHandler),window.addEventListener("ONRAMP_WIDGET_CLOSE_REQUEST_CANCELLED",this._widgetCloseCancelHandler),window.addEventListener("ONRAMP_WIDGET_READY",this._widgetReadyHandler),window.addEventListener("ONRAMP_WIDGET_FAILED",this._widgetFailedHandler)},t.prototype._teardownSDKEvents=function(){window.removeEventListener("message",this._widgetMessageHandler),window.removeEventListener("keydown",this._handleEscapeClick),window.removeEventListener("ONRAMP_WIDGET_CLOSE_REQUEST",this._widgetCloseRequestHandler),window.removeEventListener("ONRAMP_WIDGET_CLOSE_REQUEST_CONFIRMED",this._widgetCloseHandler),window.removeEventListener("ONRAMP_WIDGET_CLOSE_REQUEST_CANCELLED",this._widgetCloseCancelHandler),window.removeEventListener("ONRAMP_WIDGET_READY",this._widgetReadyHandler),window.removeEventListener("ONRAMP_WIDGET_FAILED",this._widgetFailedHandler)},t}();export{H as OnrampWebSDK};
